
# Your Package Name

A brief description of your secure-auth-utils.

## Installation

You can install this package via npm:

```bash
npm install secure-auth-utils
```

```bash
yarn add secure-auth-utils
```

## Usage

### Generating a Token

```javascript
const { generateToken } = require('secure-auth-utils');

// Generate a token
const token = generateToken({
  data: { userId: 123 },
  tokenSecret: 'your-secret-key'
});
console.log('Generated Token:', token);
```

### Decoding a Token

```javascript
const { decodedToken } = require('secure-auth-utils');

// Decode a token
const decodedData = decodedToken({
  token: 'your-encoded-token',
  tokenSecret: 'your-secret-key'
});
console.log('Decoded Data:', decodedData);
```

### Refreshing a Token

**expiresIn : Eg: 60, "2 days", "10h", "7d"**

```javascript
const { refreshTokenEncoded } = require('secure-auth-utils');

// Refresh a token with hashed password
const refreshedToken = refreshTokenEncoded({
  hashedPass: 'your-hashed-password',
  data: { userId: 123 },
  expiresIn: '7 days',
  tokenSecret: 'your-secret-key'
});
console.log('Refreshed Token:', refreshedToken);
```

```javascript
const getRefreshToken = refreshTokenEncoded({
  data:{email:"test@test.com", role: 'user',},
  hashedPass: hashedPass,
  expiresIn: '7 days',
  tokenSecret: 'your-secret-key'
})
```

**NB:** Recommend you use hashedPass (hash) for extra security . ü§´ü§êüîê..

```javascript
const tokenDecode = await decodedToken({
  token: ref_tkn,
  tokenSecret: process.env.USER_REFRESH_TOKEN
});

  if (tokenDecode.success) {
    const { data, sessionToken, role } = tokenDecode?.data
    // if use hashedPass then you get sessionToken;
    const getSalt = sessionToken?.split('####')?.[0];
    const getHash = sessionToken?.split('####')?.[1];
    //check hashed 
    // make sure encoding, algorithm are same
    const check = passwordHashing({salt: getSalt,hash: hashedPass}).hash == getHash;
    // code execute
  }
  else{
    // code execute
  }
```

### Hashing a Password

```javascript
const { passwordHashing } = require('secure-auth-utils');

// Hash a password
const hashedPassword = passwordHashing({
  password: 'your-password',
  salt: 'your-salt',
  algorithm: 'sha256',
  encoding: 'base64'
});
console.log('Hashed Password:', hashedPassword.hash);
```

### Checking Password

```javascript
const { checkPassword } = require('secure-auth-utils');

// Check if password matches hash
const isMatch = checkPassword({
  salt: 'your-salt',
  hash: 'your-hashed-password',
  password: 'your-password'
});
console.log('Password Match:', isMatch);
```

## API Reference

### generateToken(options)

Generates a JWT token.

- `options` (object):
  - `data` (object): The data payload to be included in the token.
  - `tokenSecret` (string): The secret key used for token generation.
  - `expiresIn` (string): The expiration time for the token (optional, defaults to '24h').
  - `algorithm` (string): The signing algorithm to be used (optional, defaults to "HS256").

Returns an object containing the generated token and success status.

### decodedToken(options)

Decodes a JWT token.

- `options` (object):
  - `tokenSecret` (string): The secret key used for token verification.
  - `token` (string): The JWT token to be decoded.

Returns an object containing the decoded data and success status.

### refreshTokenEncoded(options)

Refreshes a token encoded.

- `options` (object):
  - `hashedPass` (string): The hashed password (optional).
  - `data` (object): Additional data to be included in the token.
  - `expiresIn` (string): The expiration time for the token (optional).
  - `tokenSecret` (string): The secret key used for token generation.

Returns the refreshed token or null if hashedPass is not provided.

### passwordHashing(options)

Hashes a password.

- `options` (object):
  - `salt` (string): The salt used for hashing (optional, autogenerated if not provided).
  - `password` (string): The password to be hashed.
  - `algorithm` (string): The hashing algorithm to be used (optional, defaults to SHA256).
  - `encoding` (string): The encoding format for the hash (optional, defaults to 'base64').

Returns an object containing the salt, success status, and hashed password.

### checkPassword(options)

Checks if a password matches the hashed value.

- `options` (object):
  - `salt` (string): The salt used for hashing.
  - `hash` (string): The hashed password to be checked.
  - `password` (string): The password to be validated.

Returns true if the password matches the hash, false otherwise.



Replace `Your Package Name` with the actual name of your package and `secure-auth-utils` with the npm package name. Also, make sure to update the function examples with relevant data and keys.